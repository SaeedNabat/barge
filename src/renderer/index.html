<!doctype html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; worker-src 'self' blob:; connect-src 'self' data: blob:; img-src 'self' data: blob:; font-src 'self' data:;" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Barge Editor</title>
		<link rel="stylesheet" href="styles.css" />
		<link rel="stylesheet" href="../../node_modules/xterm/css/xterm.css" />
		<script src="../../node_modules/monaco-editor/min/vs/loader.js"></script>
	</head>
	<body>
		<div class="window gradient-bg">
			<div class="titlebar" style="-webkit-app-region: drag;">
				<div class="title">Barge</div>
				<div class="window-controls" style="-webkit-app-region: no-drag;">
					<button id="winMin" title="Minimize" aria-label="Minimize">
						<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#38bdf8" stroke-width="2" stroke-linecap="round"><path d="M5 19h14"/></svg>
					</button>
					<button id="winMax" title="Maximize" aria-label="Maximize">
						<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="6" width="12" height="12" rx="1"/></svg>
					</button>
					<button id="winClose" title="Close" aria-label="Close">
						<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2" stroke-linecap="round"><path d="M18 6L6 18M6 6l12 12"/></svg>
					</button>
				</div>
			</div>
			<nav class="menubar" id="menubar" style="-webkit-app-region: no-drag;">
				<div class="menu" data-menu="file">
					<span class="menu-label">File</span>
					<div class="dropdown">
						<button class="menu-item" id="mFileNew"><span>New File</span><kbd>Ctrl+N</kbd></button>
						<button class="menu-item" id="mFileOpen"><span>Open…</span><kbd>Ctrl+O</kbd></button>
						<button class="menu-item" id="mFileOpenFolder"><span>Open Folder…</span><kbd>Ctrl+K Ctrl+O</kbd></button>
						<button class="menu-item" id="mFileSave"><span>Save</span><kbd>Ctrl+S</kbd></button>
						<button class="menu-item" id="mFileSaveAll"><span>Save All</span></button>
						<button class="menu-item" id="mFileSaveAs"><span>Save As…</span><kbd>Ctrl+Shift+S</kbd></button>
						<div class="menu-sep"></div>
						<button class="menu-item" id="mFileCloseAll"><span>Close All</span></button>
						<button class="menu-item" id="mFileReopenClosed"><span>Reopen Closed Tab</span></button>
						<button class="menu-item" id="mFileExit"><span>Exit</span></button>
					</div>
				</div>
				<div class="menu" data-menu="edit">
					<span class="menu-label">Edit</span>
					<div class="dropdown">
						<button class="menu-item" id="mEditUndo"><span>Undo</span><kbd>Ctrl+Z</kbd></button>
						<button class="menu-item" id="mEditRedo"><span>Redo</span><kbd>Ctrl+Y</kbd></button>
						<div class="menu-sep"></div>
						<button class="menu-item" id="mEditFind"><span>Find</span><kbd>Ctrl+F</kbd></button>
						<button class="menu-item" id="mEditGoToLine"><span>Go to Line…</span><kbd>Ctrl+G</kbd></button>
						<button class="menu-item" id="mEditFindInFiles"><span>Find in Files</span><kbd>Ctrl+Shift+F</kbd></button>
						<button class="menu-item" id="mEditPreferences"><span>Preferences…</span><kbd>Ctrl+,</kbd></button>
					</div>
				</div>
				<div class="menu" data-menu="view">
					<span class="menu-label">View</span>
					<div class="dropdown">
						<div class="menu-item" style="pointer-events:none; opacity:.8;">Theme</div>
						<button class="menu-item" id="mThemeDark"><span>Dark</span></button>
						<button class="menu-item" id="mThemeLight"><span>Light</span></button>
						<div class="menu-sep"></div>
						<button class="menu-item" id="mViewToggleStatus"><span>Toggle Status Bar</span></button>
						<button class="menu-item" id="mViewToggleWordWrap"><span>Toggle Word Wrap</span><kbd>Alt+Z</kbd></button>
						<button class="menu-item" id="mViewToggleLineNumbers"><span>Toggle Line Numbers</span></button>
						<button class="menu-item" id="mViewToggleWhitespace"><span>Toggle Render Whitespace</span></button>
						<button class="menu-item" id="mViewToggleTerminal"><span>Toggle Terminal</span><kbd>Ctrl+`</kbd></button>
					</div>
				</div>
				<div class="menu" data-menu="help">
					<span class="menu-label">Help</span>
					<div class="dropdown">
						<button class="menu-item" id="mHelpAbout"><span>About</span></button>
					</div>
				</div>
			</nav>
			<div class="app">
				<aside class="sidebar">
					<div class="sidebar-toolbar">
						<button id="sidebarNewFile" title="New File" class="icon-btn accent" aria-label="New File">
							<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#60a5fa" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<path d="M14 2H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V9z" opacity=".6"/>
								<path d="M14 2v7h7" opacity=".6"/>
								<path d="M12 11v6M9 14h6"/>
								<path d="M6 6l1.5-.5M18 6l-1.5-.5M12 4l0-1" stroke="#93c5fd" stroke-width="1.5"/>
							</svg>
						</button>
						<button id="sidebarNewFolder" title="New Folder" class="icon-btn" aria-label="New Folder">
							<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#34d399" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<path d="M3 7h5l2 2h9a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
								<path d="M12 13v6M9 16h6"/>
							</svg>
						</button>
					</div>
					<div id="fileTree" class="file-tree"></div>
					<div id="searchPanel" class="search-panel hidden">
						<div class="search-header">Find in Files</div>
						<div class="search-controls">
							<input id="searchQuery" placeholder="Search query" />
							<label><input id="searchCase" type="checkbox" /> Case sensitive</label>
							<label><input id="searchRegex" type="checkbox" /> Regex</label>
							<button id="searchRun">Search</button>
						</div>
						<div id="searchResults" class="search-results"></div>
					</div>
				</aside>
				<main class="main">
					<header class="topbar">
						<div class="tabs" id="tabs"></div>
						<div class="actions">
							<span id="filename"></span>
						</div>
					</header>
					<div id="editor"></div>
					<div id="terminalPanel" class="terminal hidden">
						<div id="terminal" class="xterm"></div>
					</div>
					<footer class="statusbar">
						<span id="cursorPos">Ln 1, Col 1</span>
						<span id="lang">plaintext</span>
					</footer>
				</main>
			</div>
		</div>
		<!-- modals below -->
		<div id="prefsModal" class="modal hidden">
			<div class="modal-backdrop"></div>
			<div class="modal-card">
				<div class="modal-header">
					<h3>Preferences</h3>
				</div>
				<div class="modal-body">
					<label class="field">
						<span>Editor font family</span>
						<input id="prefFontFamily" type="text" placeholder="e.g. JetBrains Mono, Fira Code, monospace" />
					</label>
					<label class="field">
						<span>Editor font size</span>
						<input id="prefFontSize" type="number" min="8" max="48" step="1" />
					</label>
					<label class="field">
						<span>Auto save</span>
						<select id="prefAutoSave">
							<option value="off">Off</option>
							<option value="afterDelay">After Delay</option>
							<option value="onFocusChange">On Focus Change</option>
						</select>
					</label>
					<label class="field" id="autoSaveDelayField">
						<span>Auto save delay (ms)</span>
						<input id="prefAutoSaveDelay" type="number" min="100" max="10000" step="100" />
					</label>
				</div>
				<div class="modal-footer">
					<button id="prefsCancel" class="btn btn-ghost">Cancel</button>
					<button id="prefsSave" class="btn btn-primary">Save</button>
				</div>
			</div>
		</div>
		<div id="emptyStateModal" class="modal hidden">
			<div class="modal-backdrop"></div>
			<div class="modal-card">
				<div class="modal-header"><h3>Welcome to Barge</h3></div>
				<div class="modal-body">
					<p style="margin:0 0 8px; color:#9aa4b2;">Open a file or a folder to get started.</p>
					<div style="display:flex; gap:8px;">
						<button id="emptyOpenFile" class="btn btn-primary">Open File</button>
						<button id="emptyOpenFolder" class="btn">Open Folder</button>
					</div>
				</div>
				<div class="modal-footer">
					<button id="emptyClose" class="btn btn-ghost">Close</button>
				</div>
			</div>
		</div>
		<!-- Input Modal -->
		<div id="inputModal" class="modal hidden">
			<div class="modal-backdrop"></div>
			<div class="modal-card">
				<div class="modal-header"><h3 id="inputTitle">Enter Name</h3></div>
				<div class="modal-body">
					<label class="field">
						<span id="inputLabel">Name</span>
						<input id="inputField" type="text" autocomplete="off" />
					</label>
					<div id="inputError" style="color:#fca5a5; font-size:12px; display:none;"></div>
				</div>
				<div class="modal-footer">
					<button id="inputCancel" class="btn btn-ghost">Cancel</button>
					<button id="inputOk" class="btn btn-primary">Create</button>
				</div>
			</div>
		</div>
		<!-- Command Palette -->
		<div id="cmdPalette" class="modal hidden">
			<div id="cmdBackdrop" class="modal-backdrop"></div>
			<div id="cmdCard" class="modal-card cmd-card">
				<div class="cmd-input-wrap input-group">
					<span class="input-icon" aria-hidden="true">
						<svg width="16" height="16" viewBox="0 0 24 24" fill="none"><circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2"/><path d="M20 20l-3.5-3.5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
					</span>
					<input id="cmdInput" type="text" placeholder="Run a command… (e.g. Open File, Toggle Theme)" autocomplete="off" />
				</div>
				<div id="cmdList" class="cmd-list"></div>
				<div id="cmdEmpty" class="cmd-empty hidden">No matches. Try different keywords.</div>
			</div>
		</div>
		<!-- Load xterm browser bundle so Terminal is global -->
		<script src="../../node_modules/xterm/lib/xterm.js"></script>
		<script src="renderer.js"></script>
	</body>
</html>