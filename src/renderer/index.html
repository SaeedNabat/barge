<!doctype html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="Content-Security-Policy" content="default-src 'self' http://localhost:5173 http://127.0.0.1:5173; script-src 'self' http://localhost:5173 http://127.0.0.1:5173 'unsafe-eval'; style-src 'self' http://localhost:5173 http://127.0.0.1:5173 'unsafe-inline'; worker-src 'self' blob: http://localhost:5173 http://127.0.0.1:5173; connect-src 'self' data: blob: http://localhost:5173 http://127.0.0.1:5173 ws://localhost:5173 ws://127.0.0.1:5173; img-src 'self' data: blob:; font-src 'self' data:;" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Barge Editor</title>
		<link rel="stylesheet" href="styles.css" />
		<script src="/monaco-editor/min/vs/loader.js"></script>
	</head>
	<body>
		<div class="window gradient-bg">
			<div class="titlebar" style="-webkit-app-region: drag;">
				<div class="title">
					<img src="../assets/barge.png" alt="Barge" class="app-logo" />
					<span>Barge</span>
				</div>
				<div class="window-controls" style="-webkit-app-region: no-drag;">
					<button id="winMin" title="Minimize" aria-label="Minimize">
						<svg width="16" height="16" viewBox="0 0 24 24" fill="#38bdf8"><rect x="6" y="11" width="12" height="2" rx="1"/></svg>
					</button>
					<button id="winMax" title="Maximize" aria-label="Maximize">
						<svg width="16" height="16" viewBox="0 0 24 24" fill="#22c55e"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
					</button>
					<button id="winClose" title="Close" aria-label="Close">
						<svg width="16" height="16" viewBox="0 0 24 24" fill="#ef4444">
							<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"/>
						</svg>
					</button>
				</div>
			</div>
			<nav class="menubar" id="menubar" style="-webkit-app-region: no-drag;">
				<div class="menu" data-menu="file">
					<span class="menu-label">File</span>
					<div class="dropdown">
						<button class="menu-item" id="mFileNew"><span>New File</span><kbd>Ctrl+N</kbd></button>
						<button class="menu-item" id="mFileNewWindow"><span>New Window</span><kbd>Ctrl+Shift+N</kbd></button>
						<button class="menu-item" id="mFileOpen"><span>Open…</span><kbd>Ctrl+O</kbd></button>
						<button class="menu-item" id="mFileQuickOpen"><span>Quick Open…</span><kbd>Ctrl+P</kbd></button>
						<button class="menu-item" id="mFileOpenFolder"><span>Open Folder…</span><kbd>Ctrl+K Ctrl+O</kbd></button>
						<button class="menu-item" id="mFileCloseFolder"><span>Close Folder</span></button>
						<button class="menu-item" id="mFileSave"><span>Save</span><kbd>Ctrl+S</kbd></button>
						<button class="menu-item" id="mFileSaveAll"><span>Save All</span></button>
						<button class="menu-item" id="mFileSaveAs"><span>Save As…</span><kbd>Ctrl+Shift+S</kbd></button>
						<div class="menu-sep"></div>
						<button class="menu-item" id="mFileOpenRecentFile"><span>Open Recent File…</span></button>
						<button class="menu-item" id="mFileOpenRecentFolder"><span>Open Recent Folder…</span></button>
<button class="menu-item" id="mFileClearRecent"><span>Clear Recent Files</span></button>
						<div class="menu-sep"></div>
						<button class="menu-item" id="mFileCloseAll"><span>Close All</span></button>
						<button class="menu-item" id="mFileReopenClosed"><span>Reopen Closed Tab</span></button>
						<button class="menu-item" id="mFileExit"><span>Exit</span></button>
					</div>
				</div>
				<div class="menu" data-menu="edit">
					<span class="menu-label">Edit</span>
					<div class="dropdown">
						<button class="menu-item" id="mEditUndo"><span>Undo</span><kbd>Ctrl+Z</kbd></button>
						<button class="menu-item" id="mEditRedo"><span>Redo</span><kbd>Ctrl+Y</kbd></button>
						<div class="menu-sep"></div>
						<button class="menu-item" id="mEditFind"><span>Find</span><kbd>Ctrl+F</kbd></button>
						<button class="menu-item" id="mEditGoToLine"><span>Go to Line…</span><kbd>Ctrl+G</kbd></button>
						<button class="menu-item" id="mEditPreferences"><span>Preferences…</span><kbd>Ctrl+,</kbd></button>
					</div>
				</div>
				<div class="menu" data-menu="view">
					<span class="menu-label">View</span>
					<div class="dropdown">
						<button class="menu-item" id="mViewToggleSidebar"><span>Toggle Sidebar</span><kbd>Ctrl+B</kbd></button>
						<button class="menu-item" id="mViewSplit"><span>Split Editor</span></button>
						<button class="menu-item" id="mViewUnsplit"><span>Unsplit Editor</span></button>
						<div class="menu-sep"></div>
						<button class="menu-item" id="mViewToggleStatus"><span>Toggle Status Bar</span></button>
						<button class="menu-item" id="mViewToggleWordWrap"><span>Toggle Word Wrap</span><kbd>Alt+Z</kbd></button>
						<button class="menu-item" id="mViewToggleLineNumbers"><span>Toggle Line Numbers</span></button>
						<button class="menu-item" id="mViewToggleWhitespace"><span>Toggle Render Whitespace</span></button>
						<button class="menu-item" id="toggleMinimap"><span>Toggle Minimap</span></button>
						<button class="menu-item" id="mViewToggleTerminal"><span>Toggle Terminal</span><kbd>Ctrl+`</kbd></button>
						<button class="menu-item" id="mViewFullScreen"><span>Toggle Full Screen</span><kbd>F11</kbd></button>
						<button class="menu-item" id="mViewZenMode"><span>Toggle Zen Mode</span><kbd>Ctrl+K, Z</kbd></button>
					</div>
				</div>
				<div class="menu" data-menu="help">
					<span class="menu-label">Help</span>
					<div class="dropdown">
						<button class="menu-item" id="mHelpAbout"><span>About</span></button>
<button class="menu-item" id="mHelpKeyboardShortcuts"><span>Keyboard Shortcuts</span></button>
					</div>
				</div>
			</nav>
			<div class="app">
				<aside class="sidebar">
					<div class="sidebar-toolbar">
						<button id="sidebarNewFile" title="New File" class="toolbar-btn" aria-label="New File">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
								<polyline points="14 2 14 8 20 8"/>
								<line x1="12" y1="18" x2="12" y2="12"/>
								<line x1="9" y1="15" x2="15" y2="15"/>
							</svg>
							<span>New File</span>
						</button>
						<button id="sidebarNewFolder" title="New Folder" class="toolbar-btn" aria-label="New Folder">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
								<line x1="12" y1="11" x2="12" y2="17"/>
								<line x1="9" y1="14" x2="15" y2="14"/>
							</svg>
							<span>New Folder</span>
						</button>
					</div>
					<div id="sidebarWelcome" class="sidebar-welcome hidden">
						<div class="sidebar-welcome-buttons">
							<button id="sidebarOpenFile" class="sidebar-welcome-btn">
								<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<path d="M14 2H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V9z"/>
									<path d="M14 2v7h7"/>
								</svg>
								Open File
							</button>
							<button id="sidebarOpenFolder" class="sidebar-welcome-btn">
								<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<path d="M3 7h5l2 2h9a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
								</svg>
								Open Folder
							</button>
						</div>
					</div>
					<div class="file-tree-filter">
						<input id="fileTreeFilter" type="text" placeholder="Filter files (filename contains…)" />
					</div>
					<div id="fileTree" class="file-tree"></div>
				</aside>
				<main class="main">
					<header class="topbar">
						<div class="tabs" id="tabs"></div>
					</header>
					<div id="editorSplit" class="editor-split">
						<div id="editor"></div>
						<div id="editor2" class="hidden"></div>
						<div id="editorEmpty" class="editor-empty hidden"><div><div class="title">Welcome to Barge Editor</div><div class="subtitle">Open a file or folder to get started</div></div></div>
					</div>
					<div id="problemsPanel" class="problems hidden" aria-label="Problems Panel" role="region">
						<div class="problems-header">
							<div class="title">Problems</div>

							<div class="actions">
								<button id="problemsToggle" title="Toggle Problems (Ctrl+Shift+M)">≡</button>
							</div>
						</div>
						<div id="problemsList" class="problems-list" role="list"></div>
					</div>
					<div id="terminalPanel" class="terminal hidden">
						<div class="terminal-header">
							<div id="terminalTabs" class="terminal-tabs"></div>
							<button id="terminalNew" class="terminal-new" title="New Terminal">+</button>
							<button id="terminalClosePanel" class="terminal-close" title="Close Terminal Panel">×</button>
						</div>
						<div id="terminalViews" class="terminal-views"></div>
					</div>
				</main>
				<footer class="statusbar">
					<div class="breadcrumb" id="breadcrumb"></div>
					<span id="gitBranch" class="git-branch" title="Git branch"></span>
<span id="fileSize" class="file-size" title="File Size"></span>
<span id="readWriteMode" class="read-write-mode" title="Read/Write Mode">RW</span>
					<span id="cursorPos">Ln 1, Col 1</span>
					<span id="selection" class="selection-info" title="Selection"></span>
					<span id="lang" class="language" title="Language">Plain Text</span>
					<span id="encoding" class="encoding" title="File Encoding">UTF-8</span>
					<span id="eol" class="eol" title="End of Line Sequence">LF</span>
					<span id="tabSize" class="tab-size" title="Click to change tab size">Spaces: 4</span>
					<span id="problemsCount" class="problems-count" aria-live="polite"></span>
				</footer>
			</div>
		</div>
		<!-- modals below -->
		<!-- Quick Open -->
		<div id="quickOpen" class="modal hidden">
			<div class="modal-backdrop"></div>
			<div class="modal-card qo-card">
				<div class="cmd-input-wrap">
					<span class="input-icon" aria-hidden="true">
						<svg width="16" height="16" viewBox="0 0 24 24" fill="none"><circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2"/><path d="M20 20l-3.5-3.5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
					</span>
					<input id="qoInput" type="text" placeholder="Type to search files…" autocomplete="off" />
				</div>
				<div id="qoList" class="cmd-list"></div>
				<div id="qoEmpty" class="cmd-empty hidden">No matches. Start typing to search.</div>
			</div>
		</div>
		<div id="prefsModal" class="modal hidden">
			<div class="modal-backdrop"></div>
			<div class="modal-card">
				<div class="modal-header">
					<h3>Preferences</h3>
				</div>
				<div class="modal-body">
					<label class="field">
						<span>Theme</span>
						<select id="prefTheme">
							<option value="dark">Dark</option>
							<option value="light">Light</option>
							<option value="dracula">Dracula</option>
							<option value="nord">Nord</option>
							<option value="monokai">Monokai</option>
						</select>
					</label>
<div class="field">
<span>Theme Preview</span>
<div id="themePreview" style="margin-top: 8px; padding: 16px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); transition: all 0.3s ease;">
<div style="display: flex; gap: 8px; margin-bottom: 8px;">
<div style="width: 20px; height: 20px; border-radius: 4px; background: var(--bg-primary, #0f1419);"></div>
<div style="width: 20px; height: 20px; border-radius: 4px; background: var(--bg-secondary, #1a1e2e);"></div>
<div style="width: 20px; height: 20px; border-radius: 4px; background: var(--accent-color, #6366f1);"></div>
</div>
<div style="font-size: 11px; color: var(--text-primary, #e0e7ff); font-family: monospace;">
<span style="color: var(--accent-color, #6366f1);">function</span> <span style="color: var(--text-primary, #e0e7ff);">hello</span>() { }
</div>
</div>
</div>
<div class="field">
<button id="importCustomTheme" class="btn" style="width: 100%;">Import Custom Theme (JSON)</button>
</div>
					<label class="field">
						<span>Editor font family</span>
						<input id="prefFontFamily" type="text" placeholder="e.g. JetBrains Mono, Fira Code, monospace" />
					</label>
					<label class="field">
						<span>Editor font size</span>
						<input id="prefFontSize" type="number" min="8" max="48" step="1" />
					</label>
					<div class="field">
						<span>Tab Size <small id="prefTabSizeVal" style="opacity:.8;margin-left:6px;">4 spaces</small></span>
						<input id="prefTabSize" type="range" min="1" max="16" step="1" />
					</div>
					<label class="field">
						<span>Auto save</span>
						<select id="prefAutoSave">
							<option value="off">Off</option>
							<option value="afterDelay">After Delay</option>
							<option value="onFocusChange">On Focus Change</option>
						</select>
					</label>
					<label class="field" id="autoSaveDelayField">
						<span>Auto save delay (ms)</span>
						<input id="prefAutoSaveDelay" type="number" min="100" max="10000" step="100" />
					</label>
					<label class="field">
						<span>Format on save</span>
						<input id="prefFormatOnSave" type="checkbox" />
					</label>
					<label class="field">
						<span>Font ligatures</span>
						<input id="prefFontLigatures" type="checkbox" />
					</label>
					<label class="field">
						<span>Compact mode</span>
						<input id="prefCompactMode" type="checkbox" />
					</label>
					<label class="field">
						<span>Show Minimap</span>
						<input id="prefMinimap" type="checkbox" />
					</label>
					<div class="field">
					<span>Font Preview</span>
					<div id="fontPreview" style="padding: 12px; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; background: rgba(0,0,0,0.2); font-size: 14px; font-family: monospace; margin-top: 6px;">
					The quick brown fox jumps over the lazy dog<br>
					0123456789 != === => &gt;= &lt;=
					</div>
					</div>
					<hr style="border: none; border-top: 1px solid rgba(255,255,255,0.06); margin: 16px 0;">
					<div style="margin-bottom: 12px; font-weight: 600; color: #93c5fd;">Status Bar Items</div>
					<label class="field">
					<span>Show Cursor Position</span>
					<input id="prefStatusCursorPos" type="checkbox" />
					</label>
					<label class="field">
					<span>Show Selection Info</span>
					<input id="prefStatusSelection" type="checkbox" />
					</label>
					<label class="field">
					<span>Show Language</span>
					<input id="prefStatusLanguage" type="checkbox" />
					</label>
					<label class="field">
					<span>Show Encoding</span>
					<input id="prefStatusEncoding" type="checkbox" />
					</label>
					<label class="field">
					<span>Show Line Ending</span>
					<input id="prefStatusEol" type="checkbox" />
					</label>
					<label class="field">
					<span>Show Tab Size</span>
					<input id="prefStatusTabSize" type="checkbox" />
					</label>
					<label class="field">
					<span>Show Git Branch</span>
					<input id="prefStatusGitBranch" type="checkbox" />
					</label>
					<label class="field">
					<span>Show Problems Count</span>
					<input id="prefStatusProblems" type="checkbox" />
					</label>
<label class="field">
<span>Show File Size</span>
<input id="prefStatusFileSize" type="checkbox" />
</label>
<label class="field">
<span>Show Read/Write Mode</span>
<input id="prefStatusReadWriteMode" type="checkbox" />
</label>
					<div class="field">
						<span>Cursor Blink Rate <small id="prefCursorBlinkVal" style="opacity:.8;margin-left:6px;">1200 ms</small></span>
						<input id="prefCursorBlink" type="range" min="300" max="3000" step="100" />
					</div>
				</div>
				<div class="modal-footer">
					<button id="prefsCancel" class="btn btn-ghost">Cancel</button>
					<button id="prefsSave" class="btn btn-primary">Save</button>
				</div>
			</div>
		</div>
		<div id="emptyStateModal" class="modal hidden">
			<div class="modal-backdrop"></div>
			<div class="modal-card">
				<div class="modal-header"><h3>Welcome to Barge</h3></div>
				<div class="modal-body">
					<p style="margin:0 0 8px; color:#9aa4b2;">Open a file or a folder to get started.</p>
					<div style="display:flex; gap:8px;">
						<button id="emptyOpenFile" class="btn btn-primary">Open File</button>
						<button id="emptyOpenFolder" class="btn">Open Folder</button>
					</div>
				</div>
				<div class="modal-footer">
					<button id="emptyClose" class="btn btn-ghost">Close</button>
				</div>
			</div>
		</div>
		<!-- Input Modal -->
		<div id="inputModal" class="modal hidden">
			<div class="modal-backdrop"></div>
			<div class="modal-card">
				<div class="modal-header"><h3 id="inputTitle">Enter Name</h3></div>
				<div class="modal-body">
					<label class="field">
						<span id="inputLabel">Name</span>
						<input id="inputField" type="text" autocomplete="off" />
					</label>
					<div id="inputError" style="color:#fca5a5; font-size:12px; display:none;"></div>
				</div>
				<div class="modal-footer">
					<button id="inputCancel" class="btn btn-ghost">Cancel</button>
					<button id="inputOk" class="btn btn-primary">Create</button>
				</div>
			</div>
		</div>
		<!-- Command Palette -->
		<div id="cmdPalette" class="modal hidden">
			<div id="cmdBackdrop" class="modal-backdrop"></div>
			<div id="cmdCard" class="modal-card cmd-card">
				<div class="cmd-input-wrap input-group">
					<span class="input-icon" aria-hidden="true">
						<svg width="16" height="16" viewBox="0 0 24 24" fill="none"><circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2"/><path d="M20 20l-3.5-3.5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
					</span>
					<input id="cmdInput" type="text" placeholder="Run a command… (e.g. Open File, Toggle Theme)" autocomplete="off" />
				</div>
				<div id="cmdList" class="cmd-list"></div>
				<div id="cmdEmpty" class="cmd-empty hidden">No matches. Try different keywords.</div>
			</div>
		</div>
		
		<!-- About Modal -->
		<div id="aboutModal" class="modal hidden">
			<div class="modal-backdrop"></div>
			<div class="modal-card about-card">
				<div class="about-header">
					<img src="../assets/barge.png" alt="Barge" class="about-logo" />
					<h2>Barge Editor</h2>
					<p class="version">Version 1.0.0</p>
				</div>
				<div class="about-content">
					<p>A modern, feature-rich code editor built with Electron and Monaco Editor.</p>
					<div class="about-features">
						<h3>Features</h3>
						<ul>
							<li>Syntax highlighting for multiple languages</li>
							<li>Integrated terminal</li>
							<li>File tree navigation</li>
							<li>Dark/Light theme support</li>
							<li>Command palette</li>
							<li>Search and replace</li>
						</ul>
					</div>
					<div class="about-footer">
						<p>&copy; 2024 Barge Editor. Built with ❤️ using Electron.</p>
					</div>
				</div>
				<button id="aboutClose" class="modal-close">×</button>
			</div>
		</div>
		

<!-- Keyboard Shortcuts Modal -->
<div id="shortcutsModal" class="modal hidden">
<div class="modal-backdrop"></div>
<div class="modal-card" style="max-width: 700px;">
<div class="modal-header">
<h3>⌨️ Keyboard Shortcuts</h3>
</div>
<div class="modal-body" style="max-height: 70vh;">
<div style="display: grid; gap: 20px;">
<div>
<h4 style="color: #93c5fd; margin-bottom: 10px; font-size: 14px;">File</h4>
<div class="shortcut-list">
<div class="shortcut-item"><span>New File</span><kbd>Ctrl+N</kbd></div>
<div class="shortcut-item"><span>Open File</span><kbd>Ctrl+O</kbd></div>
<div class="shortcut-item"><span>Quick Open</span><kbd>Ctrl+P</kbd></div>
<div class="shortcut-item"><span>Save</span><kbd>Ctrl+S</kbd></div>
<div class="shortcut-item"><span>Save As</span><kbd>Ctrl+Shift+S</kbd></div>
</div>
</div>
<div>
<h4 style="color: #93c5fd; margin-bottom: 10px; font-size: 14px;">Edit</h4>
<div class="shortcut-list">
<div class="shortcut-item"><span>Undo</span><kbd>Ctrl+Z</kbd></div>
<div class="shortcut-item"><span>Redo</span><kbd>Ctrl+Y</kbd></div>
<div class="shortcut-item"><span>Find</span><kbd>Ctrl+F</kbd></div>
<div class="shortcut-item"><span>Go to Line</span><kbd>Ctrl+G</kbd></div>
<div class="shortcut-item"><span>Command Palette</span><kbd>Ctrl+Shift+P</kbd></div>
</div>
</div>
<div>
<h4 style="color: #93c5fd; margin-bottom: 10px; font-size: 14px;">View</h4>
<div class="shortcut-list">
<div class="shortcut-item"><span>Toggle Sidebar</span><kbd>Ctrl+B</kbd></div>
<div class="shortcut-item"><span>Toggle Minimap</span><kbd>Ctrl+M</kbd></div>
<div class="shortcut-item"><span>Toggle Word Wrap</span><kbd>Alt+Z</kbd></div>
<div class="shortcut-item"><span>Toggle Terminal</span><kbd>Ctrl+`</kbd></div>
<div class="shortcut-item"><span>Toggle Full Screen</span><kbd>F11</kbd></div>
<div class="shortcut-item"><span>Zen Mode</span><kbd>Ctrl+K, Z</kbd></div>
</div>
</div>
<div>
<h4 style="color: #93c5fd; margin-bottom: 10px; font-size: 14px;">Navigation</h4>
<div class="shortcut-list">
<div class="shortcut-item"><span>Go to Symbol</span><kbd>Ctrl+Shift+O</kbd></div>
<div class="shortcut-item"><span>Go to Definition</span><kbd>F12</kbd></div>
<div class="shortcut-item"><span>Switch Tabs</span><kbd>Ctrl+Tab</kbd></div>
</div>
</div>
</div>
</div>
<div class="modal-footer">
<button id="shortcutsClose" class="btn btn-ghost">Close</button>
</div>
</div>
</div>
		<!-- Load xterm browser bundle so Terminal is global -->
		<div id="recentModal" class="modal hidden">
			<div class="modal-backdrop"></div>
			<div class="modal-card recent-card">
				<div class="modal-header"><h3 id="recentTitle">Open Recent</h3></div>
				<div class="modal-body">
					<div class="recent-kind-switch">
						<button id="recentSwitchFile" class="btn btn-small btn-primary">Files</button>
						<button id="recentSwitchFolder" class="btn btn-small">Folders</button>
					</div>
					<div id="recentList" class="recent-list"></div>
				</div>
				<div class="modal-footer">
					<button id="recentCancel" class="btn btn-ghost">Close</button>
				</div>
			</div>
		</div>
		<script src="renderer.js"></script>
		<script src="ux-enhancements.js"></script>
	</body>
</html>
